# FFPP - Fast Fast Packet Processing #

## Introduction ##

This library is developed for **fast prototyping** and **teaching** fast fast packet processing inside Linux containers.
To be utilized low-level technologies including:

-   [DPDK](https://www.dpdk.org/) (v19.08): Fast packet processing in user space.
-   [XDP](https://www.iovisor.org/technology/xdp): Fast network data path in the Linux kernel.

Therefore, the "Fast Fast" (Double F) here means fast in Linux kernel space as well as user space.

FFPP currently focuses on providing DPDK C wrappers (plan to add Python bindings) that can be used to speed up packet I/O
and processing with more programmer-friendly APIs and utility functions.
C is chosen here mainly due to the fact that the DPDK library is developed in C, so it's easier to utilize all its
functionalities and newly added features via C APIs.
I prefer safer languages like [Rust](https://www.rust-lang.org/).
Unfortunately, DPDK currently does not provide official Rust bindings.
There is a user space driver written in Rust called [ixy.rs](https://github.com/ixy-languages/ixy.rs).
DPDK is currently chosen mainly due to [its support](http://core.dpdk.org/supported/) for common paravirtualization and
software NICs, high performance as well as comprehensive development documentation.

Since this library is used for my PhD research and teaching purposes, it focus on the **simplicity** and **easy-to-use**.
It can be used by a container running inside a VM.
So experiments can be performed in a lightweight container-based emulator (e.g. [ComNetsEmu](https://bitbucket.org/comnets/comnetsemu/src/master/)) on a **single** laptop.

In order to test the latest useful features, this library try to use the latest release of DPDK and XDP.
So it is not stable and experimental.

## Build Shared Library ##

In order to simplify and the build process on different platforms.
The Docker container is suggested and used in this project to build the shared library.
There is a [Dockerfile](./Dockerfile) and a [Python3 script](./util/run_dev_container.py) to automate the build process.

In order to test the latest version, libraries are compiled directly from source code.
To reduce the dev image size, unnecessary PMDs and some built-in DPDK applications are not compiled.
The compile-time configuration uses this [config file](./config).
It is copied to ${RTE_SDK}/build/.config into the Docker image.
The built `ffpp:latest` image has size of about **590MB** size (the default build takes about 5GB size).
This image includes some test utilities like gdb, valgrind, tcpdump.
The Dockerfile and config can be further customized to reduce the image size.

Make sure you have Docker CE (17.05 or higher) installed.
The container image and shared library (.so file) can be built with following steps:
(Because DPDK is compiled from the source code, the step of build the container image takes time.)

```bash
$ cd ./util/
# Build the development Docker image with all dependencies installed.
$ sudo python3 ./run_dev_container.py build_image
# Build the shared lib INSIDE the development container.
$ sudo python3 ./run_dev_container.py build_lib
```
By default, when image is built, all files in the source directory are copied into Docker container under /ffpp directory.
So the built image with name ffpp:latest contains the version of source files when image is built.
In order to avoid re-built the image every time during development, the `build_lib`, `run_test` operations provided by
the `run_dev_container.py` will mount the current source directory to `/ffpp`.
Therefore, the compiled library `libffpp.so` located in [./build](./build) directory is generated with latest source code.
This is just to adapt my personal development workflow, you can simplify modify
[run_dev_container.py](./util/run_dev_container.py) for your use cases.

## Development Guide ##

TODO(Zuo): Add development guide.

### API Documentation ###

The C API documentation is generated by [Doxygen](http://www.doxygen.nl/).
You can build and open the HTML documents with:

```bash
$ make docs
$ xdg-open docs/html/index.html
```

## Contact ##

* **Zuo Xiang** - *Project Maintainer* - Email: xianglinks@gmail.com
